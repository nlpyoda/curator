{"version":3,"file":"static/js/257.c70cbe29.chunk.js","mappings":"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","sources":["app/services/AIProductService.js","app/services/mockData.js"],"sourcesContent":["// AIProductService for React Native\nimport { MOCK_PRODUCTS } from './mockData.js';\n// Import DatabaseService only if needed to avoid OpenAI dependency issues\n// import { DatabaseService } from './DatabaseService.js';\n// Import SupabaseService dynamically to avoid build issues\n// import { SupabaseService } from './SupabaseService.js';\n\nexport class AIProductService {\n  constructor() {\n    this.useMockData = true; // Start with mock data, can be overridden\n    this.initialized = false;\n    this.MOCK_PRODUCTS = MOCK_PRODUCTS; // Store reference to mock data\n    this.databaseService = null;\n    this.supabaseService = null;\n    this.databaseAvailable = false;\n    this.supabaseAvailable = false;\n    this.activeService = 'mock'; // 'supabase', 'prisma', or 'mock'\n  }\n\n  async initialize() {\n    try {\n      console.log('Initializing AI Product Service...');\n      \n      // Try Supabase first (best for production)\n      try {\n        const { SupabaseService } = await import('./SupabaseService.js');\n        this.supabaseService = new SupabaseService();\n        const supabaseSuccess = await this.supabaseService.initialize();\n        \n        if (supabaseSuccess) {\n          const productCount = await this.supabaseService.getProductCount();\n          if (productCount > 0) {\n            this.supabaseAvailable = true;\n            this.useMockData = false;\n            this.activeService = 'supabase';\n            console.log(`✅ AI Product Service initialized with Supabase (${productCount} products)`);\n            this.initialized = true;\n            return;\n          }\n        }\n      } catch (supabaseError) {\n        console.log('Supabase not available:', supabaseError.message);\n      }\n\n      // Skip Prisma for simplicity - using Supabase + Mock only\n      console.log('⏩ Skipping Prisma database (using Supabase + Mock only)');\n\n      // Fallback to mock data\n      this.useMockData = true;\n      this.activeService = 'mock';\n      console.log('✅ AI Product Service initialized with mock data');\n      this.initialized = true;\n      \n    } catch (error) {\n      console.error('Failed to initialize AI service:', error);\n      this.useMockData = true;\n      this.activeService = 'mock';\n      this.initialized = true;\n    }\n  }\n\n  async searchProductsFromDatabase(query, persona) {\n    try {\n      // For database search, we'll use text-based search first, then potentially embeddings later\n      const normalizedQuery = query.toLowerCase().trim();\n      \n      // Search products by title, description, features, and tags\n      const products = await this.databaseService.prisma.product.findMany({\n        where: {\n          OR: [\n            { title: { contains: normalizedQuery, mode: 'insensitive' } },\n            { description: { contains: normalizedQuery, mode: 'insensitive' } },\n            { features: { contains: normalizedQuery, mode: 'insensitive' } },\n            { tags: { hasSome: normalizedQuery.split(' ') } },\n            { category: { contains: normalizedQuery, mode: 'insensitive' } },\n            { subCategory: { contains: normalizedQuery, mode: 'insensitive' } }\n          ]\n        },\n        take: 20 // Get more than we need for scoring\n      });\n\n      // Transform database format back to expected mock format for compatibility\n      const transformedProducts = products.map(product => ({\n        id: product.id,\n        title: product.title,\n        price: product.price,\n        link: product.link,\n        description: product.description,\n        features: product.features,\n        whyBuy: product.whyBuy,\n        reviews: {\n          amazon: product.amazonReviewSummary || '',\n          instagram: product.instagramReviewSummary || '',\n          marketplace: product.fbMarketplaceSummary || ''\n        },\n        prosAndCons: product.prosAndCons || { pros: [], cons: [] },\n        lastUpdated: product.lastUpdated.toISOString().split('T')[0],\n        source: product.source\n      }));\n\n      // Apply persona-based scoring similar to mock search\n      const results = transformedProducts.map(product => {\n        const personaLower = persona.toLowerCase();\n        let similarity = 0.5; // Base score\n        \n        // Increase score for persona-relevant keywords\n        if (personaLower.includes('tech') && \n          (product.title.toLowerCase().includes('macbook') || \n            product.title.toLowerCase().includes('headphones') || \n            product.title.toLowerCase().includes('smart'))) {\n          similarity += 0.3;\n        }\n        \n        if (personaLower.includes('professional') && \n          (product.description.toLowerCase().includes('professional') || \n            product.description.toLowerCase().includes('work'))) {\n          similarity += 0.2;\n        }\n        \n        if (personaLower.includes('quality') && \n          (product.prosAndCons.pros.some(pro => pro.toLowerCase().includes('quality')))) {\n          similarity += 0.2;\n        }\n        \n        return {\n          ...product,\n          similarity: Math.min(similarity, 0.97)\n        };\n      });\n      \n      // Sort by similarity and return top results\n      results.sort((a, b) => b.similarity - a.similarity);\n      \n      console.log(`Database search returned ${results.length} products`);\n      return results.slice(0, 10); // Return top 10\n      \n    } catch (error) {\n      console.error('Database search error:', error);\n      throw error;\n    }\n  }\n\n  async searchProducts(query, persona) {\n    console.log(`Searching for: ${query} with persona: ${persona} (using ${this.activeService})`);\n    \n    // Try Supabase first if available\n    if (this.supabaseAvailable && this.supabaseService) {\n      try {\n        return await this.supabaseService.searchProducts(query, persona);\n      } catch (supabaseError) {\n        console.log('Supabase search failed, falling back:', supabaseError.message);\n      }\n    }\n    \n    // Try Prisma database if available\n    if (this.databaseAvailable && this.databaseService) {\n      try {\n        return await this.searchProductsFromDatabase(query, persona);\n      } catch (dbError) {\n        console.log('Prisma search failed, falling back to mock data:', dbError.message);\n      }\n    }\n    \n    // Fallback to mock data search\n    return new Promise((resolve) => {\n      setTimeout(() => {\n        try {\n          const normalizedQuery = query.toLowerCase().trim();\n          \n          // Create more products for better testing\n          const allProducts = [...this.MOCK_PRODUCTS];\n          \n          // Add more products for certain search terms\n          if (normalizedQuery.includes('laptop') || normalizedQuery.includes('computer') || normalizedQuery.includes('macbook')) {\n            allProducts.push(\n              {\n                id: '101',\n                title: 'MacBook Pro 14\"',\n                price: '$1,999.99',\n                link: 'https://example.com/macbook-pro',\n                description: 'Powerful laptop with M2 chip, perfect for professionals and creatives.',\n                features: '- M2 Pro/Max chip\\n- 14-inch Liquid Retina XDR display\\n- Up to 32GB unified memory\\n- Up to 18 hours of battery life',\n                whyBuy: 'Exceptional performance for creative professionals with industry-leading battery life.',\n                reviews: {\n                  amazon: 'Users love the performance and battery life. The display is consistently rated as best-in-class.',\n                  instagram: 'Tech influencers praise the speed and efficiency for video editing workflows.',\n                  marketplace: 'Highly rated for reliability and resale value.'\n                },\n                prosAndCons: {\n                  pros: ['Exceptional performance', 'Beautiful display', 'Great battery life'],\n                  cons: ['Premium price', 'Limited port selection']\n                },\n                lastUpdated: '2023-12-01',\n                source: 'Apple'\n              },\n              {\n                id: '102',\n                title: 'MacBook Air M2',\n                price: '$1,199.99',\n                link: 'https://example.com/macbook-air',\n                description: 'Ultra-thin laptop with great performance and all-day battery life.',\n                features: '- M2 chip\\n- 13.6-inch Liquid Retina display\\n- Up to 24GB unified memory\\n- Up to 18 hours of battery life',\n                whyBuy: 'Perfect balance of performance and portability with no fan noise.',\n                reviews: {\n                  amazon: 'Customers love the lightweight design and silent operation.',\n                  instagram: 'Travel influencers praise its portability and battery life.',\n                  marketplace: 'High ratings for everyday performance and build quality.'\n                },\n                prosAndCons: {\n                  pros: ['Silent operation', 'Lightweight design', 'All-day battery'],\n                  cons: ['Only 2 Thunderbolt ports', 'Base model has slower SSD']\n                },\n                lastUpdated: '2023-11-15',\n                source: 'Apple'\n              },\n              {\n                id: '103',\n                title: 'MacBook Pro 16\"',\n                price: '$2,499.99',\n                link: 'https://example.com/macbook-pro-16',\n                description: 'Largest MacBook with desktop-class performance for serious professionals.',\n                features: '- M2 Pro/Max chip\\n- 16-inch Liquid Retina XDR display\\n- Up to 96GB unified memory\\n- Up to 22 hours of battery life',\n                whyBuy: 'Desktop-class performance in a portable package with the largest MacBook screen available.',\n                reviews: {\n                  amazon: 'Professional users rave about the performance for 3D rendering and complex tasks.',\n                  instagram: 'Film editors call it the best portable workstation available.',\n                  marketplace: 'Consistently rated 5 stars for professional applications.'\n                },\n                prosAndCons: {\n                  pros: ['Exceptional performance', 'Large beautiful display', 'Long battery life'],\n                  cons: ['Expensive', 'Heavier than other MacBooks']\n                },\n                lastUpdated: '2023-12-05',\n                source: 'Apple'\n              }\n            );\n          }\n          \n          if (normalizedQuery.includes('chair') || normalizedQuery.includes('office')) {\n            allProducts.push(\n              {\n                id: '104',\n                title: 'Executive Mesh Office Chair',\n                price: '$189.99',\n                link: 'https://example.com/executive-chair',\n                description: 'Premium office chair with adjustable features and breathable mesh.',\n                features: '- High back design\\n- Adjustable armrests\\n- Lumbar support\\n- 360° swivel',\n                whyBuy: 'Provides excellent support for long work days with breathable comfort.',\n                reviews: {\n                  amazon: 'Office workers report significant comfort improvement over standard chairs.',\n                  instagram: 'Home office influencers recommend for all-day sitting.',\n                  marketplace: 'Consistently rated 4.5+ stars for comfort and durability.'\n                },\n                prosAndCons: {\n                  pros: ['Very comfortable', 'Good lumbar support', 'Breathable material'],\n                  cons: ['Assembly required', 'Armrests could be sturdier']\n                },\n                lastUpdated: '2023-10-10',\n                source: 'Office Depot'\n              },\n              {\n                id: '105',\n                title: 'Gaming Chair with Footrest',\n                price: '$229.99',\n                link: 'https://example.com/gaming-chair',\n                description: 'Racing-style gaming chair with retractable footrest and adjustable features.',\n                features: '- Adjustable recline up to 155°\\n- Retractable footrest\\n- Neck and lumbar pillows\\n- Premium PU leather',\n                whyBuy: 'Designed for gamers and professionals who want maximum comfort during long sessions.',\n                reviews: {\n                  amazon: 'Gamers love the comfort for marathon gaming sessions.',\n                  instagram: 'Streamers praise the adjustable features and aesthetic look on camera.',\n                  marketplace: 'High ratings for comfort and style.'\n                },\n                prosAndCons: {\n                  pros: ['Very comfortable', 'Fully adjustable', 'Includes footrest'],\n                  cons: ['Bulky design', 'PU leather can get warm']\n                },\n                lastUpdated: '2023-09-20',\n                source: 'Amazon'\n              }\n            );\n          }\n          \n          console.log(`Query: \"${normalizedQuery}\", matching against ${allProducts.length} products`);\n          \n          // Improved search matching - look for partial matches in title, description and features\n          let filteredProducts = allProducts.filter(product => {\n            const title = product.title.toLowerCase();\n            const description = product.description.toLowerCase();\n            const features = product.features.toLowerCase();\n            \n            // Check for partial matches\n            return title.includes(normalizedQuery) || \n                   description.includes(normalizedQuery) || \n                   features.includes(normalizedQuery) ||\n                   (normalizedQuery.split(' ').some(word => \n                     title.includes(word) || description.includes(word) || features.includes(word)\n                   ));\n          });\n          \n          console.log(`First filter found ${filteredProducts.length} products`);\n          \n          // If we don't have enough matches with strict criteria, relax the search to ensure we get results\n          if (filteredProducts.length < 5) {\n            filteredProducts = allProducts.filter(product => {\n              const allText = `${product.title} ${product.description} ${product.features}`.toLowerCase();\n              \n              // Try to match any word in the query\n              return normalizedQuery.split(' ').some(word => \n                word.length > 2 && allText.includes(word)\n              );\n            });\n            \n            console.log(`Relaxed filter found ${filteredProducts.length} products`);\n          }\n          \n          // If still not enough results, just show all products\n          if (filteredProducts.length < 3) {\n            console.log('Not enough matches, showing all products');\n            filteredProducts = allProducts;\n          }\n          \n          // Calculate match scores based on persona\n          const results = filteredProducts.map(product => {\n            // Calculate a similarity score (basic example)\n            const personaLower = persona.toLowerCase();\n            let similarity = 0.5; // Base score\n            \n            // Increase score for persona-relevant keywords\n            if (personaLower.includes('tech') && \n              (product.title.toLowerCase().includes('macbook') || \n                product.title.toLowerCase().includes('headphones') || \n                product.title.toLowerCase().includes('smart'))) {\n              similarity += 0.3;\n            }\n            \n            if (personaLower.includes('professional') && \n              (product.description.toLowerCase().includes('professional') || \n                product.description.toLowerCase().includes('work'))) {\n              similarity += 0.2;\n            }\n            \n            if (personaLower.includes('quality') && \n              (product.prosAndCons.pros.some(pro => pro.toLowerCase().includes('quality')))) {\n              similarity += 0.2;\n            }\n            \n            return {\n              ...product,\n              similarity: Math.min(similarity, 0.97) // Cap at 0.97 to avoid perfect scores\n            };\n          });\n          \n          // Sort by similarity\n          results.sort((a, b) => b.similarity - a.similarity);\n          \n          console.log(`Returning ${results.length} products`);\n          resolve(results);\n        } catch (error) {\n          console.error('Error searching products:', error);\n          resolve([]);\n        }\n      }, 1000); // Simulate network delay\n    });\n  }\n\n  async cleanup() {\n    // Clean up services\n    if (this.supabaseService) {\n      try {\n        await this.supabaseService.cleanup();\n      } catch (error) {\n        console.error('Error cleaning up Supabase service:', error);\n      }\n    }\n    \n    if (this.databaseService) {\n      try {\n        await this.databaseService.cleanup();\n      } catch (error) {\n        console.error('Error cleaning up Prisma service:', error);\n      }\n    }\n    \n    this.initialized = false;\n    this.supabaseAvailable = false;\n    this.databaseAvailable = false;\n    this.activeService = 'mock';\n  }\n} ","// Mock product data for testing\nexport const MOCK_PRODUCTS = [\n  {\n    id: '1',\n    title: 'Premium Wireless Headphones',\n    price: '$299.99',\n    link: 'https://example.com/headphones',\n    description: 'High-quality wireless headphones with noise cancellation and premium sound quality.',\n    features: '- Active noise cancellation\\n- 30-hour battery life\\n- Premium audio drivers\\n- Comfortable over-ear design',\n    whyBuy: 'These headphones offer exceptional sound quality and comfort for long listening sessions.',\n    reviews: {\n      amazon: 'Users love the sound quality and battery life. Some mention they are a bit heavy.',\n      instagram: 'Influencers praise the sleek design and noise cancellation features.',\n      marketplace: 'Highly rated for durability and customer service.'\n    },\n    prosAndCons: {\n      pros: ['Excellent sound quality', 'Long battery life', 'Effective noise cancellation'],\n      cons: ['Premium price point', 'Slightly heavy for extended wear']\n    },\n    lastUpdated: '2023-09-15',\n    source: 'Amazon'\n  },\n  {\n    id: '2',\n    title: 'Smart Home Hub',\n    price: '$129.99',\n    link: 'https://example.com/smarthub',\n    description: 'Central control for all your smart home devices with voice assistant integration.',\n    features: '- Compatible with 100+ smart devices\\n- Voice control\\n- Scheduling and automation\\n- Energy monitoring',\n    whyBuy: 'This hub simplifies managing all your smart home devices from one central interface.',\n    reviews: {\n      amazon: 'Users appreciate the easy setup and wide compatibility.',\n      instagram: 'Tech reviewers highlight the intuitive app interface.',\n      marketplace: 'Buyers mention good value for the features offered.'\n    },\n    prosAndCons: {\n      pros: ['Wide device compatibility', 'Easy setup', 'Reliable connection'],\n      cons: ['Limited advanced automation without subscription']\n    },\n    lastUpdated: '2023-10-20',\n    source: 'Best Buy'\n  },\n  {\n    id: '3',\n    title: 'Ultra HD Smart TV 55\"',\n    price: '$699.99',\n    link: 'https://example.com/tv',\n    description: 'Crystal clear 4K display with smart features and streaming apps built-in.',\n    features: '- 4K Ultra HD resolution\\n- HDR support\\n- Built-in streaming apps\\n- Voice remote',\n    whyBuy: 'This TV offers excellent picture quality and smart features at a competitive price point.',\n    reviews: {\n      amazon: 'Customers love the picture quality and smart features.',\n      instagram: 'Tech influencers praise the value for money.',\n      marketplace: 'High ratings for picture quality and easy setup.'\n    },\n    prosAndCons: {\n      pros: ['Excellent picture quality', 'User-friendly interface', 'Good value'],\n      cons: ['Sound could be better', 'Limited gaming features']\n    },\n    lastUpdated: '2023-11-05',\n    source: 'Walmart'\n  },\n  {\n    id: '4',\n    title: 'Professional Blender',\n    price: '$199.99',\n    link: 'https://example.com/blender',\n    description: 'High-powered blender for smoothies, soups, and food processing.',\n    features: '- 1500W motor\\n- Variable speed control\\n- Pulse function\\n- Dishwasher-safe parts',\n    whyBuy: 'This blender can handle any blending task with ease and is built to last.',\n    reviews: {\n      amazon: 'Customers praise its power and durability.',\n      instagram: 'Food bloggers love the versatility and consistent results.',\n      marketplace: 'High ratings for build quality and performance.'\n    },\n    prosAndCons: {\n      pros: ['Powerful motor', 'Versatile functions', 'Easy to clean'],\n      cons: ['Loud operation', 'Takes up counter space']\n    },\n    lastUpdated: '2023-08-12',\n    source: 'Target'\n  },\n  {\n    id: '5',\n    title: 'Ergonomic Office Chair',\n    price: '$249.99',\n    link: 'https://example.com/chair',\n    description: 'Adjustable office chair designed for comfort during long work sessions.',\n    features: '- Adjustable lumbar support\\n- Breathable mesh back\\n- Adjustable armrests\\n- 5-year warranty',\n    whyBuy: 'This chair provides excellent support for long work days and helps prevent back pain.',\n    reviews: {\n      amazon: 'Users report reduced back pain and improved comfort.',\n      instagram: 'Work-from-home professionals recommend for all-day comfort.',\n      marketplace: 'Consistently rated highly for build quality and ergonomics.'\n    },\n    prosAndCons: {\n      pros: ['Excellent lumbar support', 'Highly adjustable', 'Durable construction'],\n      cons: ['Assembly takes time', 'Premium price point']\n    },\n    lastUpdated: '2023-07-30',\n    source: 'Office Depot'\n  },\n  {\n    id: '6',\n    title: 'iPhone 15 Pro',\n    price: '$999.00',\n    link: 'https://apple.com/iphone-15-pro',\n    description: 'Latest iPhone with titanium design, A17 Pro chip, and professional camera system.',\n    features: '- A17 Pro chip\\n- Titanium design\\n- Pro camera system\\n- USB-C connector\\n- Action Button',\n    whyBuy: '🍎 Latest iPhone with titanium design and pro features for creators and professionals.',\n    reviews: {\n      amazon: 'Users love the titanium build and improved camera capabilities.',\n      instagram: 'Tech reviewers praise the natural titanium finish and USB-C upgrade.',\n      marketplace: 'High ratings for performance and camera quality.'\n    },\n    prosAndCons: {\n      pros: ['Premium titanium design', 'Exceptional camera system', 'Professional features'],\n      cons: ['Premium pricing', 'No significant battery life improvement']\n    },\n    lastUpdated: '2024-01-15',\n    source: 'Apple Store'\n  },\n  {\n    id: '7',\n    title: 'Air Jordan 1 Retro High',\n    price: '$170.00',\n    link: 'https://nike.com/jordan-1',\n    description: 'Iconic basketball sneaker with timeless design and premium leather construction.',\n    features: '- Premium leather upper\\n- Classic colorways\\n- Air-Sole cushioning\\n- Rubber outsole\\n- Iconic silhouette',\n    whyBuy: '🏃‍♂️ Iconic basketball sneaker with timeless style that works with any outfit.',\n    reviews: {\n      amazon: 'Customers love the classic style and quality leather construction.',\n      instagram: 'Sneaker enthusiasts consistently rank this as a must-have classic.',\n      marketplace: 'High ratings for style, comfort, and durability.'\n    },\n    prosAndCons: {\n      pros: ['Timeless design', 'Premium materials', 'Versatile styling'],\n      cons: ['Can be stiff initially', 'Premium price point']\n    },\n    lastUpdated: '2024-01-10',\n    source: 'Nike'\n  },\n  {\n    id: '8', \n    title: 'Sony WH-1000XM5',\n    price: '$399.00',\n    link: 'https://sony.com/headphones/wh-1000xm5',\n    description: 'Industry-leading noise canceling headphones with exceptional sound quality.',\n    features: '- Industry-leading noise cancellation\\n- 30-hour battery life\\n- Multipoint connection\\n- Speak-to-chat technology\\n- Premium comfort',\n    whyBuy: '🎵 Industry-leading noise cancellation with premium sound quality for audiophiles.',\n    reviews: {\n      amazon: 'Users consistently rate these as the best noise-canceling headphones available.',\n      instagram: 'Audio reviewers praise the natural sound signature and comfort.',\n      marketplace: 'Top ratings for noise cancellation and sound quality.'\n    },\n    prosAndCons: {\n      pros: ['Best-in-class noise cancellation', 'Exceptional sound quality', 'All-day comfort'],\n      cons: ['Premium price', 'Touch controls can be sensitive']\n    },\n    lastUpdated: '2024-01-05',\n    source: 'Sony'\n  },\n  {\n    id: '9',\n    title: 'Dyson V15 Detect',\n    price: '$749.00', \n    link: 'https://dyson.com/v15-detect',\n    description: 'Powerful cordless vacuum with laser dust detection and advanced filtration.',\n    features: '- Laser dust detection\\n- HEPA filtration\\n- 60-minute runtime\\n- LCD display\\n- Multiple attachments',\n    whyBuy: '🌪️ Revolutionary laser technology reveals hidden dust for the most thorough clean.',\n    reviews: {\n      amazon: 'Users are amazed by the laser feature showing dust they never knew existed.',\n      instagram: 'Home cleaning enthusiasts call it a game-changer for deep cleaning.',\n      marketplace: 'High ratings for suction power and innovative features.'\n    },\n    prosAndCons: {\n      pros: ['Innovative laser detection', 'Powerful suction', 'Comprehensive filtration'],\n      cons: ['Premium price point', 'Heavy for extended use']\n    },\n    lastUpdated: '2024-01-08',\n    source: 'Dyson'\n  },\n  {\n    id: '10',\n    title: 'Samsung Galaxy S24 Ultra',\n    price: '$1,199.00',\n    link: 'https://samsung.com/galaxy-s24-ultra',\n    description: 'Premium Android smartphone with S Pen, AI features, and professional cameras.',\n    features: '- S Pen included\\n- AI photo editing\\n- 200MP main camera\\n- 5000mAh battery\\n- Titanium frame',\n    whyBuy: '📱 Most advanced Android phone with S Pen and AI features for productivity.',\n    reviews: {\n      amazon: 'Users love the S Pen functionality and camera versatility.',\n      instagram: 'Tech reviewers highlight the AI features and display quality.',\n      marketplace: 'High ratings for performance and camera capabilities.'\n    },\n    prosAndCons: {\n      pros: ['S Pen functionality', 'Excellent cameras', 'Premium build quality'],\n      cons: ['Large size', 'Premium pricing']\n    },\n    lastUpdated: '2024-01-12',\n    source: 'Samsung'\n  }\n]; "],"names":["AIProductService","constructor","this","useMockData","initialized","MOCK_PRODUCTS","databaseService","supabaseService","databaseAvailable","supabaseAvailable","activeService","initialize","console","log","SupabaseService","productCount","getProductCount","supabaseError","message","error","searchProductsFromDatabase","query","persona","normalizedQuery","toLowerCase","trim","products","prisma","product","findMany","where","OR","title","contains","mode","description","features","tags","hasSome","split","category","subCategory","take","results","map","id","price","link","whyBuy","reviews","amazon","amazonReviewSummary","instagram","instagramReviewSummary","marketplace","fbMarketplaceSummary","prosAndCons","pros","cons","lastUpdated","toISOString","source","personaLower","similarity","includes","some","pro","Object","assign","Math","min","sort","a","b","length","slice","searchProducts","dbError","Promise","resolve","setTimeout","allProducts","push","filteredProducts","filter","word","allText","cleanup"],"sourceRoot":""}